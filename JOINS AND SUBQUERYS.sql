USE BRIDGELABZ


CREATE TABLE STUDENTT(STDID INT,SNAME VARCHAR(40),SMAILID VARCHAR(40), COURSEID INT);

INSERT INTO STUDENTT(STDID,SNAME,SMAILID,COURSEID) VALUES
(101,'TEJA','TEJA@GMAIL.COM',10),
(102,'SUNIL','SUNIL@GMAIL.COM',20),
(103,'JAYANTH','JAYANTH@GMAIL.COM',30),
(104,'PAVAN','PAVAN@GMAIL.COM',40);


INSERT INTO STUDENTT(STDID,SNAME,SMAILID,COURSEID) VALUES
(105,'TEJA','TEJA@GMAIL.COM',50),
(106,'SUNIL','SUNIL@GMAIL.COM',60),
(107,'JAYANTH','JAYANTH@GMAIL.COM',70);

CREATE TABLE COURSE(COURSEID INT,CNAME VARCHAR(20),CFEE DECIMAL(6,2));
ALTER TABLE COURSE ALTER COLUMN CFEE INT;

INSERT INTO COURSE(COURSEID,CNAME,CFEE) VALUES
(0,'JAVA',10000),
(20,'c#',20000),
(30,'PYTHON',30000),
(40,'SQL',40000);

INSERT INTO COURSE(COURSEID,CNAME,CFEE) VALUES
(50,'SPTING BOOT',10000),
(90,'ASP.NET',20000),
(100,'MVC',30000);


SELECT * FROM STUDENTT;
SELECT * FROM COURSE;

SELECT * FROM STUDENTT INNER JOIN COURSE ON STUDENTT.COURSEID=COURSE.COURSEID;

SELECT *
FROM STUDENTT INNER JOIN COURSE
ON STUDENTT.COURSEID=COURSE.COURSEID;


--LEFT OUER JOIN
SELECT * 
FROM STUDENTT LEFT OUTER JOIN COURSE
ON STUDENTT.COURSEID = COURSE.COURSEID

SELECT * 
FROM STUDENTT S LEFT OUTER JOIN COURSE C
ON S.COURSEID = C.COURSEID;


--RIGHT OUTER JOIN
SELECT * 
FROM STUDENTT RIGHT OUTER JOIN COURSE
ON STUDENTT.COURSEID = COURSE.COURSEID

SELECT *
FROM STUDENTT S RIGHT OUTER JOIN COURSE C
ON S.COURSEID = C.COURSEID;


--FULL OTUER JOIN

SELECT * 
FROM STUDENTT FULL OUTER JOIN COURSE
ON STUDENTT.COURSEID = COURSE.COURSEID

SELECT *
FROM STUDENTT S FULL OUTER JOIN COURSE C
ON S.COURSEID  = C.COURSEID


SELECT * FROM STUDENTT;
SELECT * FROM COURSE;
--CROSS JOIN
SELECT * FROM 
STUDENTT CROSS JOIN COURSE 

--SELFJOIN

SELECT *FROM STUDENTT;
SELECT* FROM EMPLOYE;

SELECT E1.EMPID,E1.EMPNAME,E1.EMPSALARY
FROM EMPLOYE E1 ,EMPLOYE E2 
WHERE E1.EMPSALARY=E2.EMPSALARY AND E2.EMPNAME='SOMESH';

SELECT E1.EMPID,E1.EMPNAME,E1.EMPSALARY 
FROM EMPLOYE E1 ,EMPLOYE E2
WHERE E1.EMPSALARY=E2.EMPSALARY AND E2.EMPNAME='TEJA';


INSERT INTO EMPLOYE(EMPID,EMPNAME,EMPSALARY,DEPTID) VALUES
(13,'LUCKEY',10000.00,4);

SELECT MAX(EMPSALARY) FROM EMPLOYE;
--SINGLE ROW SUBQUERY
SELECT * FROM EMPLOYE WHERE EMPSALARY=(SELECT MAX(EMPSALARY) FROM EMPLOYE);

SELECT *FROM EMP;

SELECT EMPDEPT FROM EMP WHERE EMPNAME='TEJA' OR EMPNAME='PAVAN';


SELECT * 
FROM EMP
WHERE EMPDEPT IN 
(SELECT EMPDEPT FROM EMP WHERE EMPNAME='TEJA' OR EMPNAME='PAVAN');


CREATE TABLE Customerss (
    CustomerID INT PRIMARY KEY,
    CustomerName VARCHAR(10),
    Address VARCHAR(30),
    City VARCHAR(20),
    Country VARCHAR(20)
);

INSERT INTO Customerss (CustomerID, CustomerName, Address, City, Country) VALUES
(1, 'Teja', '111 Main St', 'ongole', 'India'),
(2, 'Sunil', '222 Main St', 'ongole', 'India'),
(3, 'pavan', '333 Main St', 'Banglore', 'India'),
(4, 'Lokesh', '444 Main St', 'Banglore', 'India'),
(5, 'Somesh', '555 Main St', 'Guntur', 'India'),
(6, 'Jayanth', '666 Main St', 'Guntur', 'India');

CREATE TABLE Orderss (
    OrderID INT PRIMARY KEY,
    OrderDate DATE,
    TotalAmount DECIMAL(10, 2),
    CustomerID INT, FOREIGN KEY (CustomerID) REFERENCES Customerss(CustomerID)
);

INSERT INTO Orderss (OrderID, OrderDate, TotalAmount,CustomerID) VALUES
(101,  '2024-01-01', 1500.00,1),
(102,  '2024-02-05', 2000.00,2),
(103,  '2024-03-10', 1000.00,3),
(104, '2024-04-15', 3000.00,4),
(105,  '2023-01-01', 15000.00,1),
(106,  '2023-02-05', 20.00,2),
(107,  '2023-03-10', 10.00,3),
(108, '2023-04-15', 30.00,4);


CREATE TABLE OrderItemss (
    OrderItemID INT PRIMARY KEY,
    ProductName NVARCHAR(100),
    Quantity INT,
    UnitPrice DECIMAL(10, 2),
    TotalPrice DECIMAL(10, 2),
	CustomerId INT FOREIGN KEY REFERENCES Customerss(CustomerId),
    OrderID INT FOREIGN KEY REFERENCES Orderss(OrderID)
);

INSERT INTO OrderItemss (OrderItemID, ProductName, Quantity, UnitPrice, TotalPrice,CustomerId,OrderID) VALUES
(1,  'Laptop', 1, 1000.00, 1000.00,1,101),
(2,  'Mouse', 2, 20.00, 40.00,1,101),
(3,  'Smartphone', 1, 800.00, 800.00,2,102),
(4,  'Monitor', 1, 300.00, 300.00,2,102),
(5,  'Keyboard', 2, 50.00, 100.00,3,103),
(6,  'Printer', 1, 150.00, 150.00,3,103),
(7,  'Phone', 1, 1000.00, 1000.00,4,104),
(8,  'Charger', 2, 20.00, 40.00,4,104),
(9,  'Sim', 1, 800.00, 800.00,5,105),
(10,  'ScreenCard', 1, 300.00, 300.00,5,105),
(11,  'Pouch', 2, 50.00, 100.00,6,106),
(12,  'Dispaly', 1, 150.00, 150.00,6,107);

SELECT * FROM ORDERITEMSS;


SELECT * FROM CUSTOMERSS WHERE City='Ongole';

SELECT * FROM ORDERSS WHERE ORDERID=101;


SELECT * FROM Customerss WHERE CustomerID IN (SELECT CustomerID FROM CUSTOMERSS WHERE City='Ongole');

SELECT MAX(TOTALAMOUNT)  FROM ORDERSS;

SELECT * FROM ORDERSS WHERE TOTALAMOUNT= (SELECT MAX(TOTALAMOUNT) FROM ORDERSS);


SELECT * FROM CUSTOMERSS WHERE CUSTOMERID IN (SELECT CustomerID FROM CUSTOMERSS WHERE City='Ongole');

SELECT * 
FROM CUSTOMERSS
WHERE CUSTOMERID
IN (SELECT CUSTOMERID FROM CUSTOMERSS WHERE CITY
IN (SELECT CITY FROM CUSTOMERSS WHERE COUNTRY='India'));

SELECT * FROM ORDERSS WHERE CUSTOMERID IN (SELECT CustomerID FROM CUSTOMERSS WHERE City='Ongole');


SELECT * FROM OrderItemss where ProductName='Laptop' OR  ProductName='Phone';




